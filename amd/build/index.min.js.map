{"version":3,"file":"index.min.js","sources":["../src/index.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/templates', 'core_form/modalform', 'core/str', 'core/toast'], function($, ajax, templates, ModalForm, {getString}, {notifyUser} ) {\n    return {\n        init: function() {\n            const loadCategory = (category = 0) => {\n                $('#catalogue-loading-icon').show();\n\n                ajax.call([{\n                    methodname: 'local_catalogue_get_admin_category',\n                    args: {\n                        category: category,\n                    }\n                }])[0].done(function(response) {\n                    // Render the category.\n                    templates.render('local_catalogue/category_list', { response: response })\n                        .done(function(html) {\n                            $('#category-container').html(html).show();\n                            $('#catalogue-loading-icon').hide();\n                        });\n                }).fail(function(ex) {\n                    console.error(ex);\n                    $('#catalogue-loading-icon').hide(); // Hide loading icon on error\n                    $('#category-container').show();\n                });\n            };\n            loadCategory();\n\n            const loadCourse = (category = 0) => {\n                $('#course-loading-icon').show();\n\n                ajax.call([{\n                    methodname: 'local_catalogue_get_admin_list_course',\n                    args: {\n                        category: category,\n                    }\n                }])[0].done(function(response) {\n                    // Render the course.\n                    templates.render('local_catalogue/course_list', { response: response })\n                        .done(function(html) {\n                            $('#course-container').html(html).show();\n                            $('#course-loading-icon').hide();\n                        });\n                }).fail(function(ex) {\n                    console.error(ex);\n                    $('#course-loading-icon').hide(); // Hide loading icon on error\n                    $('#course-container').show();\n                });\n            }\n            loadCourse();\n\n            $('#category-container').on('click', '.category-link', function() {\n                const category = $(this).data('category');\n                loadCourse(category);\n            });\n\n            $('#category-container').on('click', '.create_category_button', function(e) {\n                    e.preventDefault();\n                    const element = e.target.closest('.create_category_button');\n                    const category = element.getAttribute('data-category');\n                    const modalForm = new ModalForm({\n                        formClass: \"local_catalogue\\\\form\\\\category_form\",\n                        args: {id: element.getAttribute('data-category')},\n                        modalConfig: {title: getString('createnewcategory', 'local_catalogue', element.getAttribute('data-name'))},\n                        returnFocus: element,\n                    });\n    \n                    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e) => {\n                        window.console.log(e.detail);\n                        const data = e.detail;\n                        const id = Number(data.id) && !isNaN(Number(data.id)) ? Number(data.id) : 0;\n                        loadCategory(id);\n                    \n                        if (data.message && data.message.length > 0) {\n                          showNotification(data.message, data.success == 1 ? 'success' : 'danger');\n                        }\n                      });\n                    modalForm.show();\n            });\n\n            $('#course-container').on('click', '.create_course_button', function(e) {\n                e.preventDefault();\n                const element = e.target.closest('.create_course_button');\n                const course = element.getAttribute('data-course');\n                const category = element.getAttribute('data-category');\n                const modalForm = new ModalForm({\n                    formClass: \"local_catalogue\\\\form\\\\course_form\",\n                    args: {\n                        id: course,\n                        category: category\n                    },\n                    modalConfig: {title: getString('createnewcourse', 'local_catalogue', element.getAttribute('data-name'))},\n                    returnFocus: element,\n                });\n\n                modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e) => {\n                    window.console.log(e.detail);\n                    const data = e.detail;\n                    loadCourse(category);\n                \n                    if (data.message && data.message.length > 0) {\n                      showNotification(data.message, data.success == 1 ? 'success' : 'danger');\n                    }\n                  });\n                modalForm.show();\n            });\n            \n            $('#course-container').on('click', '.delete_course_button', function(e) {\n                e.preventDefault();\n                const element = e.target.closest('.delete_course_button');\n                const category = element.getAttribute('data-category');\n                const course = element.getAttribute('data-course');\n                ajax.call([{\n                    methodname: 'local_catalogue_admin_delete_course',\n                    args: {\n                        course: course,\n                    }\n                }])[0].done(function(response) {\n                    loadCourse(category);\n                }).fail(function(ex) {\n                    console.error(ex);\n                });\n            });\n\n            $('#category-container').on('click', '.delete_category_button', function(e) {\n                e.preventDefault();\n                const element = e.target.closest('.delete_category_button');\n                const category = element.getAttribute('data-category');\n                ajax.call([{\n                    methodname: 'local_catalogue_admin_delete_category',\n                    args: {\n                        category: category,\n                    }\n                }])[0].done(function(response) {\n                    loadCategory();\n                }).fail(function(ex) {\n                    console.error(ex);\n                });\n            });\n\n        }\n    };\n});"],"names":["define","$","ajax","templates","ModalForm","getString","notifyUser","init","loadCategory","category","show","call","methodname","args","done","response","render","html","hide","fail","ex","console","error","loadCourse","on","this","data","e","preventDefault","element","target","closest","modalForm","getAttribute","formClass","id","modalConfig","title","returnFocus","addEventListener","events","FORM_SUBMITTED","window","log","detail","Number","isNaN","message","length","showNotification","success","course"],"mappings":"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"}
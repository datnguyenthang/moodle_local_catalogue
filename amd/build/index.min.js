define("local_catalogue/index",["jquery","core/ajax","core/templates","core_form/modalform","core/str","core/toast"],(function($,ajax,templates,ModalForm,_ref,_ref2){let{getString:getString}=_ref,{notifyUser:notifyUser}=_ref2;return{init:function(){const loadCategory=function(){let category=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;$("#catalogue-loading-icon").show(),ajax.call([{methodname:"local_catalogue_get_admin_category",args:{category:category}}])[0].done((function(response){templates.render("local_catalogue/category_list",{response:response}).done((function(html){$("#category-container").html(html).show(),$("#catalogue-loading-icon").hide()}))})).fail((function(ex){console.error(ex),$("#catalogue-loading-icon").hide(),$("#category-container").show()}))};loadCategory();const loadCourse=function(){let category=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;$("#course-loading-icon").show(),ajax.call([{methodname:"local_catalogue_get_admin_list_course",args:{category:category}}])[0].done((function(response){templates.render("local_catalogue/course_list",{response:response}).done((function(html){$("#course-container").html(html).show(),$("#course-loading-icon").hide()}))})).fail((function(ex){console.error(ex),$("#course-loading-icon").hide(),$("#course-container").show()}))};loadCourse(),$("#category-container").on("click",".category-link",(function(){const category=$(this).data("category");loadCourse(category)})),$("#category-container").on("click",".create_category_button",(function(e){e.preventDefault();const element=e.target.closest(".create_category_button"),modalForm=(element.getAttribute("data-category"),new ModalForm({formClass:"local_catalogue\\form\\category_form",args:{id:element.getAttribute("data-category")},modalConfig:{title:getString("createnewcategory","local_catalogue",element.getAttribute("data-name"))},returnFocus:element}));modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(e=>{window.console.log(e.detail);const data=e.detail,id=Number(data.id)&&!isNaN(Number(data.id))?Number(data.id):0;loadCategory(id),data.message&&data.message.length>0&&showNotification(data.message,1==data.success?"success":"danger")})),modalForm.show()})),$("#course-container").on("click",".create_course_button",(function(e){e.preventDefault();const element=e.target.closest(".create_course_button"),course=element.getAttribute("data-course"),category=element.getAttribute("data-category"),modalForm=new ModalForm({formClass:"local_catalogue\\form\\course_form",args:{id:course,category:category},modalConfig:{title:getString("createnewcourse","local_catalogue",element.getAttribute("data-name"))},returnFocus:element});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(e=>{window.console.log(e.detail);const data=e.detail;loadCourse(category),data.message&&data.message.length>0&&showNotification(data.message,1==data.success?"success":"danger")})),modalForm.show()})),$("#course-container").on("click",".delete_course_button",(function(e){e.preventDefault();const element=e.target.closest(".delete_course_button"),category=element.getAttribute("data-category"),course=element.getAttribute("data-course");ajax.call([{methodname:"local_catalogue_admin_delete_course",args:{course:course}}])[0].done((function(response){loadCourse(category)})).fail((function(ex){console.error(ex)}))})),$("#category-container").on("click",".delete_category_button",(function(e){e.preventDefault();const category=e.target.closest(".delete_category_button").getAttribute("data-category");ajax.call([{methodname:"local_catalogue_admin_delete_category",args:{category:category}}])[0].done((function(response){loadCategory()})).fail((function(ex){console.error(ex)}))}))}}}));

//# sourceMappingURL=index.min.js.map